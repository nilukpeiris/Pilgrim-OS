/* --- CORE LAYOUT & AESTHETICS --- */
@import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap');

:root {
    --primary-color: #00f0ff; /* Cyan from the image */
    --bg-color: #050a10;      /* Deep space dark */
    --panel-bg: rgba(10, 20, 30, 0.95);
    --alert-color: #ff3333;
    --warning-color: #ffcc00;
}

body {
    background-color: var(--bg-color);
    color: var(--primary-color);
    font-family: 'Space Mono', monospace;
    margin: 0;
    padding: 0;
    height: 100vh; /* Full viewport height */
    width: 100vw;
    overflow: hidden; /* DISABLE SCROLLING (handled by internal elements) */
    display: flex;
    flex-direction: column;
    
    /* CRT EFFECT SETUP */
    position: relative; 
}

/* --- SCREEN CONTAINER --- */
#console-container {
    display: grid;
    grid-template-rows: 60px 1fr 100px; /* Header, Main Content, Footer/Nav */
    height: 100%;
    padding: 20px;
    box-sizing: border-box;
    gap: 20px;
    background: radial-gradient(circle at center, #0b1624 0%, #000000 100%);
}

/* --- HEADER --- */
header {
    border-bottom: 2px solid var(--primary-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 10px;
    text-shadow: 0 0 10px var(--primary-color);
}

h1 { margin: 0; font-size: 1.8rem; letter-spacing: 2px; }
.clock { font-size: 1.2rem; }

/* --- MAIN VIEWPORT (Where screens switch) --- */
#viewport {
    position: relative;
    border: 2px solid var(--primary-color);
    background-color: var(--panel-bg);
    box-shadow: 0 0 20px rgba(0, 240, 255, 0.1), inset 0 0 30px rgba(0, 0, 0, 0.8);
    border-radius: 10px;
    overflow: hidden; 
    padding: 20px;
    display: flex;
}

/* INDIVIDUAL SCREENS (Hidden by default) */
.screen {
    display: none; /* JS will toggle this */
    width: 100%;
    height: 100%;
    animation: fadeIn 0.3s ease-in-out;
    overflow-y: auto; 
}

#screen-dashboard {
    overflow-y: auto; 
}

.screen.active {
    display: block;
}

@keyframes fadeIn {
    from { opacity: 0; transform: scale(0.98); }
    to { opacity: 1; transform: scale(1); }
}

/* --- DASHBOARD LAYOUT (Sidebar + Main Log) --- */
#screen-dashboard > div {
    display: grid;
    grid-template-columns: 180px 1fr; /* Fixed width sidebar, rest for log */
    gap: 20px;
    height: 100%;
}

/* STATUS GRID STYLES */
.icon-status-grid {
    display: flex;
    flex-direction: column; 
    gap: 10px;
    align-content: start;
    padding-right: 10px;
    border-right: 1px solid rgba(0, 240, 255, 0.1);
    height: 100%; 
}

/* ICON CARD */
.icon-card {
    border: 1px solid var(--primary-color);
    background: rgba(0, 240, 255, 0.05);
    padding: 5px;
    border-radius: 3px;
    text-align: center;
    line-height: 1.1;
    transition: all 0.2s;
    cursor: default;
    flex-grow: 1; 
}

.icon-card.wide {
    padding: 8px 5px;
}

.icon-symbol {
    font-size: 2.0rem;
    margin-bottom: 3px;
    text-shadow: 0 0 10px var(--primary-color);
}

.icon-label {
    font-size: 0.7rem;
    text-transform: uppercase;
    opacity: 0.8;
}

.icon-status-text {
     font-size: 0.6rem;
     opacity: 0.6;
     margin-top: 2px;
}

/* --- LOG WINDOW --- */
#log-container {
    border: 2px solid var(--primary-color);
    background: black;
    padding: 15px;
    font-size: 0.9rem;
    border-radius: 5px;
    font-family: 'Courier New', monospace;
    box-shadow: inset 0 0 10px rgba(0, 240, 255, 0.4);
    height: 100%; 
    display: flex; 
    flex-direction: column; 
    gap: 5px;
}

#terminalLog {
     white-space: pre-wrap;
     flex-grow: 1;
     overflow-y: auto; 
     padding-bottom: 5px; 
}

.command-prompt {
    display: flex;
    align-items: center;
    border-top: 1px dashed rgba(0, 240, 255, 0.2);
    padding-top: 5px;
    flex-shrink: 0; 
}

.command-prompt span {
    font-size: 1.1rem;
    margin-right: 5px;
    color: var(--warning-color); 
}

#commandInput {
    background: transparent !important;
    border: none !important;
    color: var(--primary-color) !important;
    padding: 0 !important;
    margin: 0 !important;
    width: 100% !important; 
    font-family: 'Courier New', monospace !important;
    font-size: 0.9rem !important;
    outline: none !important; 
}

/* --- BOTTOM NAVIGATION BAR --- */
#nav-bar {
    display: flex;
    justify-content: center;
    gap: 20px;
    align-items: center;
    background: linear-gradient(to top, #050a10, #111);
    border-top: 1px solid #333;
    padding-top: 10px;
}

.nav-btn {
    background: transparent;
    border: 2px solid var(--primary-color);
    color: var(--primary-color);
    padding: 15px 30px;
    font-family: 'Space Mono', monospace;
    font-size: 1.1rem;
    font-weight: bold;
    cursor: pointer;
    text-transform: uppercase;
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
    transition: all 0.2s;
    clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%); 
}

.nav-btn:hover, .nav-btn.active {
    background: var(--primary-color);
    color: #000;
    box-shadow: 0 0 20px var(--primary-color);
}

/* --- FORM ELEMENTS (General styles) --- */
input[type="text"] {
    background: rgba(0,0,0,0.5);
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 8px;
    font-family: 'Space Mono', monospace;
    margin-right: 10px;
    font-size: 1rem;
}

button.action-btn {
    background: transparent;
    border: 2px solid var(--primary-color); 
    color: var(--primary-color);
    padding: 8px 15px; 
    cursor: pointer;
    font-family: 'Space Mono', monospace;
    font-size: 1rem;
    font-weight: bold;
    text-transform: uppercase;
    box-shadow: 0 0 5px rgba(0, 240, 255, 0.2); 
    transition: all 0.2s;
    clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%); 
    margin-top: 10px; 
    
    /* FIX: Button size only contains the text */
    width: auto; 
    display: inline-block; 
}

button.action-btn:hover { 
    background: var(--primary-color); 
    color: #000; 
    box-shadow: 0 0 10px var(--primary-color); 
}

/* --- GAUGE (Used for O2) --- */
.gauge-container { height: 8px; background: #333; width: 100%; margin-top: 3px; }
.gauge-fill { height: 100%; background: var(--primary-color); width: 75%; transition: width 0.5s; }

/* --- STATUS COLORS --- */
.icon-card.critical { color: var(--alert-color); border-color: var(--alert-color) !important; animation: blink 2s infinite; }
.icon-card.warning { color: var(--warning-color); border-color: var(--warning-color) !important; }
.icon-card.nominal { color: var(--primary-color); border-color: var(--primary-color) !important; }

@keyframes blink { 50% { opacity: 0.5; } }

/* --- OTHER STATUS CARD (Used in Nav/Personnel/Engineering) --- */
.status-card {
    border: 1px solid var(--primary-color);
    padding: 15px;
    border-radius: 5px;
    background: rgba(0, 240, 255, 0.05);
    box-shadow: inset 0 0 10px rgba(0, 240, 255, 0.05);
    height: fit-content;
    
    display: flex;
    flex-direction: column;
    margin-bottom: 0; 
}

/* --- NAVIGATION CORE STYLES --- */
#nav-main-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Two equal columns */
    gap: 20px;
    height: calc(100% - 30px); 
    overflow-y: auto; 
}

.nav-left-column, .nav-right-column {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

#navClues {
    flex-grow: 1; 
    list-style-type: disc;
    margin-left: 20px;
    overflow-y: auto;
}

#navLogicPanel {
    font-size: 0.9rem; 
}

#navLogicPanel p, #navLogicPanel label {
    font-size: 0.9rem; 
    font-family: 'Courier New', monospace; 
}

#navLogicPanel input[type="text"] {
    font-family: 'Courier New', monospace; 
    font-size: 0.9rem;
    width: 200px !important; 
    margin-left: 5px;
}

#navLogicPanel button.action-btn {
    margin-top: 15px; 
    align-self: flex-start; 
}

/* --- PERSONNEL STYLES --- */
#personnel-main-grid {
    display: grid;
    grid-template-columns: 1fr 2fr; /* Desktop default layout */
    gap: 20px;
    height: 100%; 
}

/* Roster List Specifics */
#crewList {
    overflow-y: auto; 
    flex-grow: 1; 
    list-style-type: none; 
    padding: 0;
    margin-bottom: 0; 
}

.personnel-file-card {
    display: flex;
    flex-direction: column;
    height: 100%; 
}

.personnel-content-grid {
    display: grid;
    grid-template-columns: 200px 1fr; /* Desktop photo/text layout */
    gap: 15px;
    flex-grow: 1; 
    overflow: hidden; 
    padding-top: 10px; 
}

.personnel-photo-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-right: 15px;
    border-right: 1px solid rgba(0, 240, 255, 0.1);
}

#photoContainer {
    width: 100%; 
    max-height: 200px; 
    min-height: 150px;
    border: 2px dashed var(--primary-color);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

#personnelPhoto {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
}

.access-controls {
    text-align: center;
    width: 100%;
}

.access-controls input[type="text"] {
    width: 80%; 
    text-align: center;
    margin-bottom: 5px;
}

.personnel-text-display {
    display: flex;
    flex-direction: column;
    height: 100%;
}

#personnelFileDisplay {
    flex-grow: 1; 
    border: 1px solid var(--primary-color);
    padding: 10px;
    background: black;
    box-shadow: inset 0 0 5px rgba(0, 240, 255, 0.2);
    
    min-height: 250px; 
    overflow-y: auto; 
    white-space: pre-wrap; 
    word-wrap: break-word; 
}
/* --- END PERSONNEL STYLES --- */


/* --- ENGINEERING STYLES --- */
.engineering-column {
    display: flex;
    flex-direction: column;
    gap: 20px; 
    height: 100%;
}

.engineering-column > .status-card:first-child {
    flex-grow: 0; 
    flex-shrink: 0;
}

.engineering-column > .status-card:last-child {
    flex-grow: 1; 
    display: flex; 
    flex-direction: column;
}

#hull-diagram-container img, #engineStatusImage {
    max-width: 100%;
    max-height: 100%; 
    height: auto;
    object-fit: contain; 
    display: block;
    margin: auto; 
    border: 1px dashed var(--primary-color);
    flex-grow: 1; 
}

.status-card h3 {
    flex-shrink: 0;
}

/* --- MOBILE OPTIMIZATION (Media Query) --- */
@media (max-width: 768px) {
    
    /* 1. Stack the Personnel Grid Vertically */
    #personnel-main-grid {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto; 
        gap: 15px; 
    }

    /* Adjust the photo/text grid within the file card */
    .personnel-content-grid {
        grid-template-columns: 1fr; /* Stack the photo area above the text display */
        grid-template-rows: auto 1fr;
    }
    
    .personnel-photo-area {
        border-right: none; 
        border-bottom: 1px solid rgba(0, 240, 255, 0.1); /* Add a horizontal divider */
        padding-bottom: 15px;
        margin-bottom: 10px;
    }

    /* Ensure the roster is scrollable within its smaller area if needed */
    #crewList {
        max-height: 200px; 
    }
    
    /* General Mobile Adjustments */
    #console-container {
        padding: 10px;
        gap: 10px;
        grid-template-rows: 50px 1fr 60px; /* Smaller header and nav */
    }

    h1 { font-size: 1.2rem; }
    
    #screen-dashboard > div {
        grid-template-columns: 1fr; /* Stack dashboard elements vertically */
        grid-template-rows: auto 1fr;
    }
    
    .icon-status-grid {
        border-right: none;
        padding-right: 0;
        flex-direction: row; /* Make icons horizontal on small screens */
        flex-wrap: wrap;
        height: auto;
    }

    .icon-card {
        flex-basis: 48%; /* Two icons per row */
        flex-grow: 1;
        margin-bottom: 5px;
    }

    .icon-card.wide {
        flex-basis: 100%; /* O2 gauge takes full width */
    }
    
    .nav-btn {
        padding: 10px 15px;
        font-size: 0.9rem;
    }
}


/* --- ANALOG CRT / SCANLINE EFFECT --- */

@keyframes flicker {
    0% { 
        opacity: 0.70; 
        filter: brightness(1.0); 
        text-shadow: 0 0 1px var(--primary-color);
    }
    15% { 
        opacity: 0.85; 
    }
    30% { 
        opacity: 0.75; 
        filter: brightness(1.05); 
    }
    45% { 
        opacity: 0.82; 
    }
    60% { 
        opacity: 0.70; 
        text-shadow: 0 0 1px var(--primary-color);
    }
    100% { 
        opacity: 0.90; 
        filter: brightness(1.1); 
        text-shadow: 
            0 0 1px var(--primary-color), 
            0 0 8px rgba(0, 240, 255, 0.2); 
    }
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9998; 

    background: 
        repeating-linear-gradient(
            to bottom,
            rgba(0, 0, 0, 0.15),
            rgba(0, 0, 0, 0.15) 1px,
            transparent 1px,
            transparent 2px
        );
    
    opacity: 0.75; 
    animation: flicker 0.1s infinite alternate; 
}

body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9997; 

    background: 
        radial-gradient(
            ellipse at center, 
            rgba(0, 0, 0, 0) 60%, 
            rgba(0, 0, 0, 0.4) 100%
        );
}

#vertical-scanline {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 9999; 
    
    background: linear-gradient(to bottom, 
        transparent, 
        rgba(0, 240, 255, 0.2) 3px, 
        transparent 4px
    );
    
    animation: horizontalSweep 12s linear infinite; 
}

@keyframes horizontalSweep { 
    0% { transform: translateY(-10vh); } 
    100% { transform: translateY(110vh); } 
}

/* --- NEW: GLITCH/SEIZURE EFFECT STYLES --- */
body.glitch-active {
    /* Apply blur and distortion */
    filter: blur(2px) contrast(1.1);
    
    /* Simulate a sudden screen shift/seizure */
    transform: perspective(1000px) rotateX(1deg) translateY(-2px);
    
    /* Make the transition immediate when applying the class */
    transition: none; 
    
    /* Add a flicker/seizure animation */
    animation: seizure 0.15s steps(2, end) infinite alternate;
}

body.glitch-transition {
    /* Use a quick transition to smoothly restore the view */
    transition: filter 0.2s ease-out, transform 0.2s ease-out;
}

@keyframes seizure {
    0% { transform: translate(1px, 1px) }
    50% { transform: translate(-1px, 0) scaleX(1.005) }
    100% { transform: translate(0, -1px) }
}